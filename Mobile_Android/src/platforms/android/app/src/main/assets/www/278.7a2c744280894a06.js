"use strict";(self.webpackChunkmoneyguard=self.webpackChunkmoneyguard||[]).push([[278],{5278:(b,d,i)=>{i.r(d),i.d(d,{HistoricoModule:()=>P});var l=i(9808),p=i(5861),g=i(3905),v=i(8982),t=i(5e3),x=i(232),C=i(4832),T=i(4455),Z=i(7261),y=i(8966),m=i(4218),A=i(3441),H=i(773),_=i(2181),c=i(1125),u=i(4623),M=i(508);function S(e,a){1&e&&(t.TgZ(0,"div",2),t._UZ(1,"mat-spinner",3),t.qZA())}function O(e,a){1&e&&t._UZ(0,"mat-spinner",2)}function D(e,a){if(1&e&&(t.TgZ(0,"mat-list-item"),t.TgZ(1,"div",12),t.TgZ(2,"p",13),t._uU(3),t.qZA(),t.TgZ(4,"p",14),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.qZA(),t.qZA()),2&e){const o=a.$implicit,n=t.oxw(4);t.xp6(3),t.Oqu(o.year),t.xp6(1),t.ekj("importeNegativo",o.balance<0),t.xp6(1),t.Oqu(t.xi3(6,4,o.balance,n._userService.userCurrency))}}function N(e,a){if(1&e&&(t.TgZ(0,"mat-list"),t.YNc(1,D,7,7,"mat-list-item",11),t.qZA()),2&e){const o=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",o.itemDetail)}}function Y(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"mat-expansion-panel",10),t.NdJ("opened",function(){const r=t.CHM(o).$implicit;return t.oxw(2).loadHistoricDetails(r)}),t.TgZ(1,"mat-expansion-panel-header"),t.TgZ(2,"mat-panel-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-panel-description"),t._uU(5),t.ALo(6,"currency"),t.qZA(),t.qZA(),t.YNc(7,O,1,0,"mat-spinner",0),t.YNc(8,N,2,1,"mat-list",1),t.qZA()}if(2&e){const o=a.$implicit,n=t.oxw(2);t.xp6(3),t.hij(" ",o.description," "),t.xp6(1),t.ekj("importeNegativo",o.balance<0),t.xp6(1),t.hij(" ",t.xi3(6,6,o.balance,n._userService.userCurrency)," "),t.xp6(2),t.Q6J("ngIf",n.loadingDetail),t.xp6(1),t.Q6J("ngIf",!n.loadingDetail)}}function F(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",4),t.TgZ(2,"div",5),t.TgZ(3,"app-saldo",6),t.NdJ("saldoClicked",function(){return t.CHM(o),t.oxw().showOpenSaldo()}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(4,"div",7),t.TgZ(5,"mat-accordion",8),t.YNc(6,Y,9,9,"mat-expansion-panel",9),t.qZA(),t.qZA(),t.qZA()}if(2&e){const o=t.oxw();t.xp6(3),t.Q6J("titulo",o.historicalBalanceTitle)("saldo",o.saldoActual),t.xp6(3),t.Q6J("ngForOf",o.conceptosTotales)}}let I=(()=>{class e{constructor(o,n,s,r,f,z,j){this._diarioService=o,this._userService=n,this.calculationService=s,this.snackBar=r,this.saldoAbierto=f,this.translate=z,this._helperService=j,this.loading=!1,this.loadingDetail=!1,this.saldoActual=0}get historicalBalanceTitle(){return this.translate.instant("historical.balance")}ngOnInit(){this.getData()}getIngresos(){return this.calculationService.getIngresos(this.convertToNumberArray(this.conceptosTotales))}getEgresos(){return this.calculationService.getEgresos(this.convertToNumberArray(this.conceptosTotales))}getData(){var o=this;return(0,p.Z)(function*(){o.loading=!0;const n=o._diarioService.getConceptosTotalHistorico();try{const s=yield(0,g.z)(n);o.conceptosTotales=s,o.saldoActual=o.getIngresos()-o.getEgresos(),o.loading=!1}catch(s){o.loading=!1,o._helperService.showSnackBarError(o.snackBar,o._helperService.getErrorMessage(s))}})()}convertToNumberArray(o){if(void 0!==o){const n=[];return o.forEach(function(s){n.push(s.balance)}),n}return[]}loadHistoricDetails(o){var n=this;return(0,p.Z)(function*(){n.loadingDetail=!0,n.itemDetail=[];const s=n._diarioService.getConceptosMovimHistorico(o.conceptId);try{const r=yield(0,g.z)(s);n.itemDetail=r,n.loadingDetail=!1}catch(r){n.loading=!1,n._helperService.showSnackBarError(n.snackBar,n._helperService.getErrorMessage(r))}})()}showOpenSaldo(){const o=[],n={title:this.translate.instant("historical.historical"),icon:"blur_linear",ingresos:this.getIngresos(),egresos:this.getEgresos(),concept:"historico",date:null};o.push(n),this.saldoAbierto.open(v.G,{width:"500px",data:{saldos:o}})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(x.C),t.Y36(C.f),t.Y36(T.H),t.Y36(Z.ux),t.Y36(y.uw),t.Y36(m.sK),t.Y36(A.W))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-historico"]],decls:2,vars:2,consts:[["class","loading",4,"ngIf"],[4,"ngIf"],[1,"loading"],["diameter","70","strokeWidth","5"],[1,"header"],[1,"column","saldos"],[1,"saldos",3,"titulo","saldo","saldoClicked"],[1,"tableContent"],[1,"conceptos-table"],[3,"opened",4,"ngFor","ngForOf"],[3,"opened"],[4,"ngFor","ngForOf"],["matLine",""],[1,"itemDescription"],[1,"itemAmount"]],template:function(o,n){1&o&&(t.YNc(0,S,2,0,"div",0),t.YNc(1,F,7,3,"div",1)),2&o&&(t.Q6J("ngIf",n.loading),t.xp6(1),t.Q6J("ngIf",!n.loading))},directives:[l.O5,H.$g,_.q,c.pp,l.sg,c.ib,c.yz,c.yK,c.u4,u.i$,u.Tg,M.X2],pipes:[l.H9],styles:[".header[_ngcontent-%COMP%]{display:table;margin:0 auto;clear:both;width:60%;text-align:center}.column[_ngcontent-%COMP%]{float:left;width:100%}.saldos[_ngcontent-%COMP%]{margin-top:15px}.tableContent[_ngcontent-%COMP%]{display:flex;justify-content:center;position:fixed;width:100%;height:84%;top:16%;overflow-y:scroll;max-block-size:-webkit-fill-available}.conceptos-table[_ngcontent-%COMP%]{width:60%}.mat-expansion-panel-header-description[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.itemDescription[_ngcontent-%COMP%]{float:left;font-size:small}.itemAmount[_ngcontent-%COMP%]{float:right;font-size:small}@media only screen and (max-width: 600px){.conceptos-table[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]{width:100%}}"]}),e})();var h=i(1787);const B=[{path:"",component:I}];let E=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[h.Bz.forChild(B)],h.Bz]}),e})();var J=i(7612);let P=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[l.ez,E,J.m,m.aw]]}),e})()}}]);